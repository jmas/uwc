(function outer(t,e,r){function n(r){if(e[r])return e[r].exports;if(t[r])return o(r,n);throw Error('cannot find module "'+r+'"')}function o(n,o){var i=e[n]={exports:{}},s=t[n],a=s[2],c=s[0];return c.call(i.exports,function(e){var r=t[n][1][e];return o(r?r:e)},i,i.exports,outer,t,e,r),a&&(e[a]=e[n]),e[n].exports}var i=function(){return this}();for(var s in r)r[s]?i[r[s]]=n(s):n(s);return n.duo=!0,n.cache=e,n.modules=t,n})({1:[function(t){"use strict";function e(t,e){if("string"!=typeof t)return console.warn("name should be a string."),void 0;var r=document.createElement("DIV");if(r.setAttribute("class","page-item"),r.setAttribute("data-page",t),"function"==typeof e){var n=e(r,x);n!==void 0&&null!==n&&h.isNode(n)&&r.appendChild(n)}b.appendChild(r),w.push({name:t,el:r})}function r(t){if("string"!=typeof t)return console.warn("name should be a string."),void 0;for(var e,r=0,n=w.length;n>r;r++)e=w[r],e.name===t?e.el.classList.add("active"):e.el.classList.remove("active");x.emit("page.activated",t)}function n(){function t(){e=location.hash.substring(1),e!==r&&(j.dispatch(e),r=e,h.scrollTo(document.body,0,5e3)),setTimeout(t,10)}var e,r=null;t()}function o(){var t=document.createElement("DIV");if("function"==typeof v){var e=v(t,x);e!==void 0&&null!==e&&h.isNode(e)&&t.appendChild(e)}g.appendChild(t)}function i(t,e){t=t||"",k.push({type:t,message:e}),setTimeout(function(){k.splice(0,1)},5e3)}function s(){var t=l.render({notifies:k.slice(0)});h.replaceHtml(y,t)}"undefined"==typeof console&&(window.console=console={log:function(){},error:function(){},warning:function(){}});var a=t("component/router"),c=t("component/emitter"),u=t("jmas/arr"),p=t("./store-service.js"),h=t("./dom.js"),l=t("./templates/notify.hg"),d=t("./parts/products.js"),f=t("./parts/product.js"),v=t("./parts/cart.js"),m=t("./parts/checkout.js");t("./parts/messages.js");var b=document.getElementById("page-list"),g=document.getElementById("cart-content"),y=document.getElementById("notify"),w=[],x=new c,j=new a,k=new u;k.on("change",s),x.on("error",function(t){i("error",t)}),x.on("info",function(t){i("info",t)}),x.on("success",function(t){i("success",t)}),p.on("error",function(t){x.emit("error",t)}),p.on("checkout.finished",function(){location.href="#/checkout-prompt"}),e("products",d),e("product",f),e("checkout",m),o(),j.get("/",function(){r("products"),x.emit("page.activated.products")}),j.get("/product/:id",function(t){r("product"),x.emit("page.activated.product",t)}),j.get("/checkout-prompt",function(){r("checkout")}),n()},{"component/router":2,"component/emitter":3,"jmas/arr":4,"./store-service.js":5,"./dom.js":6,"./templates/notify.hg":7,"./parts/products.js":8,"./parts/product.js":9,"./parts/cart.js":10,"./parts/checkout.js":11,"./parts/messages.js":12}],2:[function(t,e){function r(){this.routes=[]}try{var n=t("route-component")}catch(o){var n=t("route")}e.exports=r,r.prototype.get=function(t,e,r){var o=new n(t);return this.routes.push(o),e&&o.before(e),r&&o.after(r),o},r.prototype.dispatch=function(t){var e;this.teardown();for(var r=0;this.routes.length>r;r++){var n=this.routes[r];if(e=n.match(t)){this.route=n,this.args=e.args,n.call("before",e.args);break}}},r.prototype.teardown=function(){var t=this.route;t&&t.call("after",this.args)}},{route:13}],13:[function(t,e){function r(t){this.path=t,this.keys=[],this.regexp=n(t,this.keys),this._before=[],this._after=[]}var n=t("path-to-regexp");e.exports=r,r.prototype.before=function(t){return this._before.push(t),this},r.prototype.after=function(t){return this._after.push(t),this},r.prototype.call=function(t,e){e=e||[];var r=this["_"+t];if(!r)throw Error("invalid type");for(var n=0;r.length>n;n++)r[n].apply(null,e)},r.prototype.match=function(t){var e=this.keys,r=t.indexOf("?"),n=~r?t.slice(0,r):t,o=this.regexp.exec(n),i=[],s=[];if(!o)return!1;for(var a=1,c=o.length;c>a;++a){var u=e[a-1],p="string"==typeof o[a]?decodeURIComponent(o[a]):o[a];u?i[u.name]=void 0!==i[u.name]?i[u.name]:p:i.push(p),s.push(p)}return i.args=s,i}},{"path-to-regexp":14}],14:[function(t,e){function r(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function n(t,e,s){e&&!Array.isArray(e)&&(s=e,e=null),e=e||[],s=s||{};var a=s.strict,c=s.end!==!1,u=s.sensitive?"":"i",p=0;if(t instanceof RegExp){var h=t.source.match(/\((?!\?)/g)||[];return e.push.apply(e,h.map(function(t,e){return{name:e,delimiter:null,optional:!1,repeat:!1}})),i(t,e)}if(Array.isArray(t))return t=t.map(function(t){return n(t,e,s).source}),i(RegExp("(?:"+t.join("|")+")",u),e);t=t.replace(o,function(t,n,o,i,s,a,c,u){if(n)return n;if(u)return"\\"+u;var h="+"===c||"*"===c,l="?"===c||"*"===c;return e.push({name:i||p++,delimiter:o||"/",optional:l,repeat:h}),o=o?"\\"+o:"",s=r(s||a||"[^"+(o||"\\/")+"]+?"),h&&(s=s+"(?:"+o+s+")*"),l?"(?:"+o+"("+s+"))?":o+"("+s+")"});var l="/"===t[t.length-1];return a||(t=(l?t.slice(0,-2):t)+"(?:\\/(?=$))?"),c||(t+=a&&l?"":"(?=\\/|$)"),i(RegExp("^"+t+(c?"$":""),u),e)}e.exports=n,console.log("DEPRECATED use https://github.com/pillarjs/path-to-regexp");var o=RegExp(["(\\\\.)","([\\/.])?(?:\\:(\\w+)(?:\\(((?:\\\\.|[^)])*)\\))?|\\(((?:\\\\.|[^)])*)\\))([+*?])?","([.+*?=^!:${}()[\\]|\\/])"].join("|"),"g"),i=function(t,e){return t.keys=e,t}},{}],3:[function(t,e){function r(t){return t?n(t):void 0}function n(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},r.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,o=0;r.length>o;o++)if(n=r[o],n===e||n.fn===e){r.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,o=r.length;o>n;++n)r[n].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],4:[function(t,e){(function(t){function r(){var t=this;return!t instanceof r&&(t=new r),1===arguments.length&&"number"==typeof arguments[0]&&0===arguments[0]%1?o.apply(t,Array(arguments[0])):o.apply(t,arguments),t.events={},t}var n=Array.prototype.pop,o=Array.prototype.push,i=Array.prototype.reverse,s=Array.prototype.shift,a=Array.prototype.sort,c=Array.prototype.splice,u=Array.prototype.unshift;r.prototype=[],r.prototype.events={},r.prototype.get=function(t,e){return this[t]===void 0?e:this[t]},r.prototype.on=function(t,e){return this.events[t]===void 0&&(this.events[t]=[]),this.events[t].push(e),this},r.prototype.trigger=function(t,e){if(e=e||[],t instanceof Array){for(var r=0,n=t.length;n>r;r++)if(void 0!==this.events[t[r]])for(var o=0,i=this.events[t[r]].length;i>o;o++)this.events[t[r]][o].apply(this,[e])}else for(var o=0,i=this.events[t].length;i>o;o++)this.events[t][o].apply(this,[e]);return this},r.prototype.update=function(t){if(!t instanceof Function)throw Error("handler should be an Function");var e,r,n,o=[];for(n=0,len=this.length;len>n;n++)e=this[n],r=t.apply(this,[e,n]),r!==void 0&&(this[n]=r,o.push(r));return o.length>0&&(this.events.change!==void 0||this.events.update!==void 0)&&this.trigger(["change","update"],{type:"update",items:o}),this},r.prototype.insert=function(t){if(!t instanceof Array)throw Error("items should be an Array");return o.apply(this,t),(this.events.change!==void 0||this.events.insert!==void 0)&&this.trigger(["change","insert"],{type:"insert",items:t}),this},r.prototype.remove=function(t){if(t===void 0)return this.length>0&&this.splice(0,this.length),this;if(!t instanceof Function)throw Error("handler should be an Function");var e,r=[],n=[];for(e=0,len=this.length;len>e;e++)isRemove=t.apply(this,[this[e],e]),isRemove===!0?r.push(this[e]):n.push(this[e]);return c.apply(this,[0,this.length]),o.apply(this,n),r.length>0&&(this.events.change!==void 0||this.events.remove!==void 0)&&this.trigger(["change","remove"],{type:"remove",items:r}),this},r.prototype.set=function(t,e){if(!t instanceof Number)throw Error("index should be an Number");return this[t]=e,(this.events.change!==void 0||this.events.update!==void 0)&&this.trigger(["change","update"],{type:"update",items:[this[t]]}),this},r.prototype.pop=function(){var t=n.apply(this,arguments);return(this.events.change!==void 0||this.events.remove!==void 0)&&this.trigger(["change","remove"],{type:"remove",items:[t]}),t},r.prototype.push=function(){var t=o.apply(this,arguments);return(this.events.change!==void 0||this.events.insert!==void 0)&&this.trigger(["change","insert"],{type:"insert",items:Array.prototype.slice.call(arguments,0)}),t},r.prototype.reverse=function(){var t=i.apply(this,arguments);return(this.events.change!==void 0||this.events.update!==void 0)&&this.trigger(["change","update"],{type:"update",items:Array.prototype.slice.call(t,0)}),t},r.prototype.shift=function(){var t=s.apply(this,arguments);return(this.events.change!==void 0||this.events.remove!==void 0)&&this.trigger(["change","remove"],{type:"remove",items:[t]}),t},r.prototype.sort=function(){var t=a.apply(this,arguments);return(this.events.change!==void 0||this.events.update!==void 0)&&this.trigger(["change","update"],{type:"update",items:Array.prototype.slice.call(t,0)}),t},r.prototype.splice=function(){var t=c.apply(this,arguments);return t.length>0&&(this.events.change!==void 0||this.events.remove!==void 0)&&this.trigger(["change","remove"],{type:"remove",items:Array.prototype.slice.call(t,0)}),arguments.length>2&&(this.events.change!==void 0||this.events.insert!==void 0)&&this.trigger(["change","insert"],{type:"insert",items:Array.prototype.slice.call(arguments,2)}),t},r.prototype.unshift=function(){var t=u.apply(this,arguments);return(this.events.change!==void 0||this.events.insert!==void 0)&&this.trigger(["change","insert"],{type:"insert",items:[t]}),t},e!==void 0?e.exports=r:t.Arr=r})(this)},{}],5:[function(t,e){"use strict";var r=t("visionmedia/superagent"),n=t("jmas/arr"),o=t("component/emitter");e.exports=new o({products:new n,cartProducts:new n,addProductToCart:function(t,e){var n=this;e=e||1,r.post("/api/order/products/"+t).query({amount:e}).end(function(t){return t.ok?t.body.result===void 0?(n.emit("error","Результат неизвестен."),void 0):(n.loadCartProducts(),void 0):(n.emit("error","Не удалось получить данные с сервера."),void 0)})},removeProductFromCart:function(t){var e=this;r.del("/api/order/products/"+t).end(function(r){if(!r.ok)return e.emit("error","Не удалось получить данные с сервера."),void 0;if(r.body.result===void 0)return e.emit("error","Результат неизвестен."),void 0;e.cartProducts.remove(function(e){return e.id==t}),e.products.update(function(e){return e.id==t?(e._inCart=!1,e):void 0});try{e.updateProductsInCart()}catch(n){console.error(n)}})},loadCartProducts:function(){var t=this;r.get("/api/order/products").end(function(e){if(!e.ok)return t.emit("error","Не удалось получить данные с сервера."),void 0;if(e.body.result===void 0)return t.emit("error","Результат неизвестен."),void 0;try{for(var r=e.body.result,n=0,o=r.length;o>n;n++)r[n]._inCart=!0;t.cartProducts.length=0,t.cartProducts.insert(r)}catch(i){console.error(i)}t.updateProductsInCart(),console.log("loaded cart products")})},updateProductsInCart:function(){for(var t=this.products.slice(0),e=this.cartProducts.slice(0),r=0,n=t.length;n>r;r++){for(var o=0,i=e.length;i>o;o++)if(t[r].id===e[o].id){t[r]._inCart=!0;break}t[r]._inCart===void 0&&(t[r]._inCart=!1)}this.products.length=0,this.products.insert(t)},loadProducts:function(){var t=this;r.get("/api/product").end(function(e){if(!e.ok)return t.emit("error","Не удалось получить данные с сервера."),void 0;if(e.body.result===void 0)return t.emit("error","Результат неизвестен."),void 0;try{var r=e.body.result;t.products.length=0,t.products.insert(r),t.updateProductsInCart()}catch(n){console.error(n)}})},checkout:function(){var t=this;r.post("/api/order").send({purchased:"1"}).end(function(e){if(!e.ok)return t.emit("error","Не удалось получить данные с сервера."),void 0;if(e.body.result===void 0)return t.emit("error","Результат неизвестен."),void 0;t.emit("checkout.finished");try{t.cartProducts.remove()}catch(r){console.error(r)}})}})},{"visionmedia/superagent":15,"jmas/arr":4,"component/emitter":3}],15:[function(t,e){function r(){}function n(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(){if(m.XMLHttpRequest&&("file:"!=m.location.protocol||!m.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function i(t){return t===Object(t)}function s(t){if(!i(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function a(t){for(var e,r,n={},o=t.split("&"),i=0,s=o.length;s>i;++i)r=o[i],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function c(t){var e,r,n,o,i=t.split(/\r?\n/),s={};i.pop();for(var a=0,c=i.length;c>a;++a)r=i[a],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),o=b(r.slice(e+1)),s[n]=o;return s}function u(t){return t.split(/ *; */).shift()}function p(t){return v(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),o=r.shift();return n&&o&&(t[n]=o),t},{})}function h(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text=this.xhr.responseText,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function l(t,e){var r=this;f.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){try{var e=new h(r);"HEAD"==t&&(e.text=null),r.callback(null,e)}catch(n){var o=Error("Parser is unable to parse the response");o.parse=!0,o.original=n,r.callback(o)}})}function d(t,e){return"function"==typeof e?new l("GET",t).end(e):1==arguments.length?new l("GET",t):new l(t,e)}var f=t("emitter"),v=t("reduce"),m="undefined"==typeof window?this:window,b="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};d.serializeObject=s,d.parseString=a,d.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},d.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},d.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},h.prototype.get=function(t){return this.header[t.toLowerCase()]},h.prototype.setHeaderProperties=function(){var t=this.header["content-type"]||"";this.type=u(t);var e=p(t);for(var r in e)this[r]=e[r]},h.prototype.parseBody=function(t){var e=d.parse[this.type];return e&&t&&t.length?e(t):null},h.prototype.setStatusProperties=function(t){var e=0|t/100;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},h.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",o=Error(n);return o.status=this.status,o.method=e,o.url=r,o},d.Response=h,f(l.prototype),l.prototype.use=function(t){return t(this),this},l.prototype.timeout=function(t){return this._timeout=t,this},l.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},l.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},l.prototype.set=function(t,e){if(i(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},l.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},l.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},l.prototype.type=function(t){return this.set("Content-Type",d.types[t]||t),this},l.prototype.accept=function(t){return this.set("Accept",d.types[t]||t),this},l.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},l.prototype.query=function(t){return"string"!=typeof t&&(t=s(t)),t&&this._query.push(t),this},l.prototype.field=function(t,e){return this._formData||(this._formData=new FormData),this._formData.append(t,e),this},l.prototype.attach=function(t,e,r){return this._formData||(this._formData=new FormData),this._formData.append(t,e,r),this},l.prototype.send=function(t){var e=i(t),r=this.getHeader("Content-Type");if(e&&i(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},l.prototype.callback=function(t,e){var r=this._callback;return 2==r.length?r(t,e):t?this.emit("error",t):(r(e),void 0)},l.prototype.crossDomainError=function(){var t=Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},l.prototype.timeoutError=function(){var t=this._timeout,e=Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},l.prototype.withCredentials=function(){return this._withCredentials=!0,this},l.prototype.end=function(t){var e=this,i=this.xhr=o(),s=this._query.join("&"),a=this._timeout,c=this._formData||this._data;if(this._callback=t||r,i.onreadystatechange=function(){return 4==i.readyState?0==i.status?e.aborted?e.timeoutError():e.crossDomainError():(e.emit("end"),void 0):void 0},i.upload&&(i.upload.onprogress=function(t){t.percent=100*(t.loaded/t.total),e.emit("progress",t)}),a&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},a)),s&&(s=d.serializeObject(s),this.url+=~this.url.indexOf("?")?"&"+s:"?"+s),i.open(this.method,this.url,!0),this._withCredentials&&(i.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof c&&!n(c)){var u=d.serialize[this.getHeader("Content-Type")];u&&(c=u(c))}for(var p in this.header)null!=this.header[p]&&i.setRequestHeader(p,this.header[p]);return this.emit("request",this),i.send(c),this},d.Request=l,d.get=function(t,e,r){var n=d("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},d.head=function(t,e,r){var n=d("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.del=function(t,e){var r=d("DELETE",t);return e&&r.end(e),r},d.patch=function(t,e,r){var n=d("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.post=function(t,e,r){var n=d("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.put=function(t,e,r){var n=d("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},e.exports=d},{emitter:3,reduce:16}],16:[function(t,e){e.exports=function(t,e,r){for(var n=0,o=t.length,i=3==arguments.length?r:t[n++];o>n;)i=e.call(null,i,t[n],++n,t);return i}},{}],6:[function(t,e){"use strict";e.exports={removeChildNodes:function(t){if(!this.isNode(t))return console.warn("node is wrong."),void 0;for(;t.firstChild;)t.removeChild(t.firstChild)},replaceHtml:function(t,e){this.removeChildNodes(t),this.html(t,e)},appendHtml:function(t,e){this.html(t,e,"beforeend")},html:function(t,e,r){return r=r||"beforeend",!e instanceof String?(console.warn("html is not string."),void 0):t?(t.insertAdjacentHTML(r,e),void 0):(console.warn("node is wrong."),void 0)},isNode:function(t){return"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},scrollTo:function(t,e){t.scrollTop=e},addListener:function(t,e,r){t.addEventListener!==void 0?t.addEventListener(e,r,!1):t.attachEvent!==void 0?t.attachEvent("on"+e,r):t["on"+e]=r}}},{}],7:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div id="message-list" class="message-list">'),n.b("\n"+r),n.s(n.f("notifies",t,e,1),t,e,0,60,118,"{{ }}")&&(n.rs(t,e,function(t,e,n){n.b('  <div class="message-item '),n.b(n.v(n.f("type",t,e,0))),n.b('">'),n.b(n.v(n.f("message",t,e,0))),n.b("</div>"),n.b("\n"+r)}),t.pop()),n.b("</div>"),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],17:[function(t,e,r){var n={};(function(t){function e(t,e,r){var n;return e&&"object"==typeof e&&(void 0!==e[t]?n=e[t]:r&&e.get&&"function"==typeof e.get&&(n=e.get(t))),n}function r(t,e,r,n,o,i){function s(){}function a(){}s.prototype=t,a.prototype=t.subs;var c,u=new s;u.subs=new a,u.subsText={},u.buf="",n=n||{},u.stackSubs=n,u.subsText=i;for(c in e)n[c]||(n[c]=e[c]);for(c in n)u.subs[c]=n[c];o=o||{},u.stackPartials=o;for(c in r)o[c]||(o[c]=r[c]);for(c in o)u.partials[c]=o[c];return u}function n(t){return(null===t||void 0===t?"":t)+""}function o(t){return t=n(t),p.test(t)?t.replace(i,"&amp;").replace(s,"&lt;").replace(a,"&gt;").replace(c,"&#39;").replace(u,"&quot;"):t}t.Template=function(t,e,r,n){t=t||{},this.r=t.code||this.r,this.c=r,this.options=n||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(){return""},v:o,t:n,render:function(t,e,r){return this.ri([t],e||{},r)},ri:function(t,e,r){return this.r(t,e,r)},ep:function(t,e){var n=this.partials[t],o=e[n.name];if(n.instance&&n.base==o)return n.instance;if("string"==typeof o){if(!this.c)throw Error("No compiler available.");o=this.c.compile(o,this.options)}if(!o)return null;if(this.partials[t].base=o,n.subs){e.stackText||(e.stackText={});for(key in n.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);o=r(o,n.subs,n.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=o,o},rp:function(t,e,r,n){var o=this.ep(t,r);return o?o.ri(e,r,n):""},rs:function(t,e,r){var n=t[t.length-1];if(!h(n))return r(t,e,this),void 0;for(var o=0;n.length>o;o++)t.push(n[o]),r(t,e,this),t.pop()},s:function(t,e,r,n,o,i,s){var a;return h(t)&&0===t.length?!1:("function"==typeof t&&(t=this.ms(t,e,r,n,o,i,s)),a=!!t,!n&&a&&e&&e.push("object"==typeof t?t:e[e.length-1]),a)},d:function(t,r,n,o){var i,s=t.split("."),a=this.f(s[0],r,n,o),c=this.options.modelGet,u=null;if("."===t&&h(r[r.length-2]))a=r[r.length-1];else for(var p=1;s.length>p;p++)i=e(s[p],a,c),void 0!==i?(u=a,a=i):a="";return o&&!a?!1:(o||"function"!=typeof a||(r.push(u),a=this.mv(a,r,n),r.pop()),a)},f:function(t,r,n,o){for(var i=!1,s=null,a=!1,c=this.options.modelGet,u=r.length-1;u>=0;u--)if(s=r[u],i=e(t,s,c),void 0!==i){a=!0;break}return a?(o||"function"!=typeof i||(i=this.mv(i,r,n)),i):o?!1:""},ls:function(t,e,r,o,i){var s=this.options.delimiters;return this.options.delimiters=i,this.b(this.ct(n(t.call(e,o)),e,r)),this.options.delimiters=s,!1},ct:function(t,e,r){if(this.options.disableLambda)throw Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,r)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,r,n,o,i,s){var a,c=e[e.length-1],u=t.call(c);return"function"==typeof u?n?!0:(a=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(u,c,r,a.substring(o,i),s)):u},mv:function(t,e,r){var o=e[e.length-1],i=t.call(o);return"function"==typeof i?this.ct(n(i.call(o)),o,r):i},sub:function(t,e,r,n){var o=this.subs[t];o&&(this.activeSub=t,o(e,r,this,n),this.activeSub=!1)}};var i=/&/g,s=/</g,a=/>/g,c=/\'/g,u=/\"/g,p=/[&<>\"\']/,h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}})(r!==void 0?r:n)},{}],8:[function(t,e){"use strict";function r(){for(var t,e=[],r=0,o=p.length;o>r;r++)t=p.get(r),t._priceFormatted=s.formatCur(parseFloat(t.price),2,3," ",","),e.push(c.render(t));var i=a.render({products:e.join("")});n.replaceHtml(u,i),console.log("render products")}var n=t("../dom.js"),o=t("../store-service.js"),i=t("jmas/throttle"),s=t("../format.js"),a=t("../templates/products.hg"),c=t("../templates/product-item.hg"),u=document.createElement("DIV"),p=o.products;p.on("change",i(r)),e.exports=function(t,e){return console.log("products bootstrap."),e.on("page.activated.products",function(){o.loadProducts(),console.log("activated products page")}),u}},{"../dom.js":6,"../store-service.js":5,"jmas/throttle":18,"../format.js":19,"../templates/products.hg":20,"../templates/product-item.hg":21}],18:[function(t,e){(function(t){var r=function(t,e,r){var n,o,i;return function(){o=arguments,i=!0,r=r||this,n||function(){i?(t.apply(r,o),i=!1,n=setTimeout(arguments.callee,e)):n=null}()}};e!==void 0?e.exports=r:t.throttle=r})(this)},{}],19:[function(t,e){e.exports={formatCur:function(t,e,r,n,o){var i="\\d(?=(\\d{"+(r||3)+"})+"+(e>0?"\\D":"$")+")",t=t.toFixed(Math.max(0,~~e));return(o?t.replace(".",o):t).replace(RegExp(i,"g"),"$&"+(n||","))}}},{}],20:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div id="main-product-list" class="product-list hor-list">'),n.b("\n"+r),n.b("	"),n.b(n.t(n.f("products",t,e,0))),n.b("\n"+r),n.b("</div>"),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],21:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div class="product-item">'),n.b("\n"+r),n.b('  <a class="product-image" href="#/product/'),n.b(n.v(n.f("id",t,e,0))),n.b('">'),n.b("\n"+r),n.b('    <img src="'),n.b(n.v(n.f("image",t,e,0))),n.b('" alt="'),n.b(n.v(n.f("name",t,e,0))),n.b('" />'),n.b("\n"+r),n.s(n.f("amount",t,e,1),t,e,0,137,183,"{{ }}")&&(n.rs(t,e,function(t,e,n){n.b('    <div class="amount">'),n.b(n.v(n.f("amount",t,e,0))),n.b("</div>"),n.b("\n"+r)}),t.pop()),n.b("  </a>"),n.b("\n"+r),n.b('  <div class="product-summary">'),n.b("\n"+r),n.b('    <a class="name" href="#/product/'),n.b(n.v(n.f("id",t,e,0))),n.b('">'),n.b(n.v(n.f("name",t,e,0))),n.b("</a>"),n.b("\n"+r),n.b('    <div class="price">'),n.b(n.v(n.f("_priceFormatted",t,e,0))),n.b(" грн.</div>"),n.b("\n"+r),n.b('    <span class="action-btn '),n.s(n.f("_inCart",t,e,1),t,e,0,385,391,"{{ }}")&&(n.rs(t,e,function(t,e,r){r.b("remove")}),t.pop()),n.s(n.f("_inCart",t,e,1),t,e,1,0,0,"")||n.b("accept"),n.b('" data-cart="'),n.b(n.v(n.f("id",t,e,0))),n.b('" '),n.s(n.f("_inCart",t,e,1),t,e,0,466,482,"{{ }}")&&(n.rs(t,e,function(t,e,r){r.b("data-cart-remove")}),t.pop()),n.b(">"),n.s(n.f("_inCart",t,e,1),t,e,0,507,513,"{{ }}")&&(n.rs(t,e,function(t,e,r){r.b("Убрать")}),t.pop()),n.s(n.f("_inCart",t,e,1),t,e,1,0,0,"")||n.b("В корзину"),n.b("</span>"),n.b("\n"+r),n.b("  </div>"),n.b("\n"+r),n.b("</div>"),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],9:[function(t,e){"use strict";function r(){var t=v;t.amount=1,t._priceFormatted=u.formatCur(parseFloat(t.price),2,3," ",",");var e=h.render(t),r=p.render({product_view:e});i.replaceHtml(f,r);var o=document.getElementById("product-view-buy-with-list"),s=document.getElementById("product-view-view-with-list"),a=document.getElementById("product-view-cart-with-list");if(m.length>0)var c=n(m,l);else var c=d.render();if(b.length>0)var y=n(b,l);else var y=d.render();if(g.length>0)var w=n(g,l);else var w=d.render();i.replaceHtml(o,c),i.replaceHtml(s,y),i.replaceHtml(a,w);var x=document.getElementById("product-view-amount"),j=document.getElementById("product-view-cart-btn");i.addListener(x,"change",function(){var t=parseInt(this.value);isNaN(t)&&(t=1),j.setAttribute("data-amount",t)}),console.log("render product.")}function n(t,e){for(var r,n=[],o=0,i=t.length;i>o;o++)r=t[o],r._priceFormatted=u.formatCur(parseFloat(r.price),2,3," ",","),n.push(e.render(t[o]));return n.join("")}function o(t){function e(e){c.get("/api/product/"+t).end(function(t){return t.ok?(v=t.body.result!==void 0?t.body.result:{},e(),console.log("loadProducts - product."),void 0):(y.emit("error","Не удалось получить данные с сервера."),e(),void 0)})}e(function(){a([function(e){c.get("/api/product/view-with/"+t).end(function(t){return t.ok?(b=t.body.result!==void 0?t.body.result:[],e(),console.log("loadProducts - view-with."),void 0):(y.emit("error","Не удалось получить данные с сервера."),e(),void 0)})},function(e){c.get("/api/product/cart-with/"+t).end(function(t){return t.ok?(g=t.body.result!==void 0?t.body.result:[],e(),console.log("loadProducts - cart-with."),void 0):(y.emit("error","Не удалось получить данные с сервера."),e(),void 0)})},function(e){c.get("/api/product/buy-with/"+t).end(function(t){return t.ok?(m=t.body.result!==void 0?t.body.result:[],e(),console.log("loadProducts - buy-with."),void 0):(y.emit("error","Не удалось получить данные с сервера."),e(),void 0)})}],s(r))})}var i=t("../dom.js"),s=t("jmas/throttle"),a=t("jmas/parallel"),c=t("visionmedia/superagent"),u=t("../format.js"),p=t("../templates/product.hg"),h=t("../templates/product-view.hg"),l=t("../templates/product-item.hg"),d=t("../templates/recomends-empty.hg"),f=document.createElement("DIV"),v={},m=[],b=[],g=[],y=null;e.exports=function(t,e){return console.log("product bootstrap."),y=e,y.on("page.activated.product",function(t){o(t),console.log("activated product page with id #"+t)}),f}},{"../dom.js":6,"jmas/throttle":18,"jmas/parallel":22,"visionmedia/superagent":15,"../format.js":19,"../templates/product.hg":23,"../templates/product-view.hg":24,"../templates/product-item.hg":21,"../templates/recomends-empty.hg":25}],22:[function(t,e){(function(){"use strict";var t=this||window,r=function(t){"function"==typeof setImmediate?setImmediate(t):"undefined"!=typeof process&&process.nextTick?process.nextTick(t):setTimeout(t,0)},n=function(t,e){for(var n=0,o=function(){n++,n===t.length&&"function"==typeof e&&e.apply(null,[])},i=0,s=t.length;s>i;i++)(function(t){r(function(){"function"==typeof t&&t.apply(null,[o])})})(t[i])};"undefined"!=typeof define&&define.amd?define([],function(){return n}):e!==void 0&&e.exports?e.exports=n:t.parallel=n})()},{}],23:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b(n.t(n.f("product_view",t,e,0))),n.b("\n"),n.b("\n"+r),n.b('<div id="product-view-back">'),n.b("\n"+r),n.b('  <a class="action-btn" href="#/">Вернуться к списку товаров</a>'),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.b("\n"+r),n.b("<h3>Товары, которые покупают с этим товаром</h3>"),n.b("\n"),n.b("\n"+r),n.b('<div id="product-view-buy-with-list" class="product-list hor-list"></div>'),n.b("\n"),n.b("\n"+r),n.b("<h3>Товары, которые просматриваются с этим товаром</h3>"),n.b("\n"),n.b("\n"+r),n.b('<div id="product-view-view-with-list" class="product-list hor-list"></div>'),n.b("\n"),n.b("\n"+r),n.b("<h3>Товары, которые добавляются в корзину с этим товаром</h3>"),n.b("\n"),n.b("\n"+r),n.b('<div id="product-view-cart-with-list" class="product-list hor-list"></div>'),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],24:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div id="product-view">'),n.b("\n"+r),n.b('  <div class="product-image">'),n.b("\n"+r),n.b('    <img src="'),n.b(n.v(n.f("image",t,e,0))),n.b('" alt="'),n.b(n.v(n.f("name",t,e,0))),n.b('" />'),n.b("\n"+r),n.b("  </div>"),n.b("\n"+r),n.b('  <div class="product-summary">'),n.b("\n"+r),n.b('    <span class="name">'),n.b(n.v(n.f("name",t,e,0))),n.b("</span>"),n.b("\n"+r),n.b('    <div class="price">'),n.b(n.v(n.f("_priceFormatted",t,e,0))),n.b(" грн.</div>"),n.b("\n"+r),n.b('    <div class="amount">'),n.b("\n"+r),n.b('      <input id="product-view-amount" type="text" value="1" />'),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b('    <span id="product-view-cart-btn" class="action-btn accept" data-cart="'),n.b(n.v(n.f("id",t,e,0))),n.b('" data-cart-amount="'),n.b(n.v(n.f("amount",t,e,0))),n.b('">В корзину</span>'),n.b("\n"+r),n.b("  </div>"),n.b("\n"+r),n.b("</div>"),n.fl()
},partials:{},subs:{}})},{"hogan-runtime":17}],25:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div class="empty recomends-empty">Эта рекомендация недоступна, но скоро здесь появятся товары.</div>'),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],10:[function(t,e){"use strict";function r(){var t=[];if(b.length>0){for(var e,r=0,n=0,o=b.length;o>n;n++)e=b.get(n),e._priceFormatted=u.formatCur(parseFloat(e.price),2,3," ",","),t.push(l.render(e)),r+=e.price*e.amount;var i=p.render({products:t.join("")});f.classList.add("active"),v.innerHTML=u.formatCur(parseFloat(Math.ceil(100*r)/100),2,3," ",",")}else f.classList.remove("active"),i=h.render();s.replaceHtml(d,i),console.log("render cart")}function n(){s.addListener(document.getElementsByTagName("BODY")[0],"click",function(t){var e=t.target.getAttribute!==void 0?t.target.getAttribute("data-cart"):null,r=t.target.getAttribute!==void 0?t.target.getAttribute("data-amount"):null;null!==e&&(t.target.hasAttribute!==void 0&&t.target.hasAttribute("data-cart-remove")?(a.removeProductFromCart(e),i.emit("success","Товар убран из корзины")):(a.addProductToCart(e,r),i.emit("success","Товар добавлен в корзину")))})}function o(){s.addListener(m,"click",function(){a.checkout()})}var i,s=t("../dom.js"),a=t("../store-service.js"),c=t("jmas/throttle"),u=t("../format.js"),p=t("../templates/cart.hg"),h=t("../templates/cart-empty.hg"),l=t("../templates/product-item.hg"),d=document.createElement("DIV"),f=document.getElementById("cart-checkout"),v=document.getElementById("cart-checkout-price"),m=document.getElementById("cart-checkout-btn"),b=a.cartProducts;a.cartProducts.on("change",c(r)),n(),o(),e.exports=function(t,e){return console.log("cart bootstrap."),i=e,a.loadCartProducts(),i.on("cart.add",function(t){a.addProductToCart(t)}),d}},{"../dom.js":6,"../store-service.js":5,"jmas/throttle":18,"../format.js":19,"../templates/cart.hg":26,"../templates/cart-empty.hg":27,"../templates/product-item.hg":21}],26:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div id="cart-product-list" class="product-list">'),n.b("\n"+r),n.b("  "),n.b(n.t(n.f("products",t,e,0))),n.b("\n"+r),n.b("</div>"),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],27:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div class="empty">В корзине нет продуктов.<br />Нажмите «В корзину» чтобы товар очутился здесь.</div>'),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],11:[function(t,e){"use strict";var r=t("../dom.js"),n=t("../templates/checkout.hg"),o=document.createElement("DIV"),i=n.render();r.replaceHtml(o,i),e.exports=function(){return console.log("checkout bootstrap."),o}},{"../dom.js":6,"../templates/checkout.hg":28}],28:[function(t,e){var r=t("hogan-runtime").Template;e.exports=new r({code:function(t,e,r){var n=this;return n.b(r=r||""),n.b('<div id="checkout-prompt">'),n.b("\n"+r),n.b('	<p><img src="images/accept.png" /></p>'),n.b("\n"+r),n.b("	<p><b>Ваш заказ принят!</b></p>"),n.b("\n"+r),n.b("	<p>Скоро мы вам позвоним и уточним куда и как доставить заказ.</p>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.b("\n"+r),n.b('<div id="checkout-back">'),n.b("\n"+r),n.b('  <a class="action-btn" href="#/">Вернуться к списку товаров</a>'),n.b("\n"+r),n.b("</div>"),n.fl()},partials:{},subs:{}})},{"hogan-runtime":17}],12:[function(t,e){"use strict";t("../dom.js"),t("jmas/throttle"),t("jmas/parallel"),t("../store-service.js");var r=document.createElement("DIV");e.exports=function(){return console.log("checkout bootstrap."),r}},{"../dom.js":6,"jmas/throttle":18,"jmas/parallel":22,"../store-service.js":5}]},{},{1:""});